category: Utilities
commonfields:
  id: EmailRepTest
  version: -1
configuration:
- defaultvalue: https://emailrep.io
  display: Server URL (e.g. https://emailrep.io)
  name: url
  required: true
  type: 0
- additionalinfo: Mandatory for emailrep-email-address-report command
  display: API Key
  name: apikey
  required: false
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: EmailRep Provides email address reputation and reports.
display: EmailRepTest
name: EmailRepTest
script:
  commands:
  - arguments:
    - default: false
      description: Email address to get reputation for
      isArray: false
      name: email_address
      required: true
      secret: false
    deprecated: false
    description: Get EmailRep reputation for email address
    execution: false
    name: emailrep-email-reputation-get
    outputs:
    - contextPath: EmailRep.Email.email
      type: String
      description: email address queried
    - contextPath: EmailRep.Email.reputation
      type: String
      description: high/medium/low/none
    - contextPath: EmailRep.Email.suspicious
      type: Boolean
      description: whether the email address should be treated as suspicious or risky
    - contextPath: EmailRep.Email.references
      type: Number
      description: total number of positive and negative sources of reputation. note
        that these may not all be direct references to the email address, but can
        include reputation sources for the domain or other related information
    - contextPath: EmailRep.Email.details.blacklisted
      type: Boolean
      description: the email is believed to be malicious or spammy
    - contextPath: EmailRep.Email.details.malicious_activity
      type: Boolean
      description: the email has exhibited malicious behavior (e.g. phishing or fraud)
    - contextPath: EmailRep.Email.details.malicious_activity_recent
      type: Boolean
      description: malicious behavior in the last 90 days (e.g. in the case of temporal
        account takeovers)
    - contextPath: EmailRep.Email.details.credentials_leaked
      type: Boolean
      description: credentials were leaked at some point in time (e.g. a data breach,
        pastebin, dark web, etc.)
    - contextPath: EmailRep.Email.details.credentials_leaked_recent
      type: Boolean
      description: credentials were leaked in the last 90 days
    - contextPath: EmailRep.Email.details.data_breach
      type: Boolean
      description: the email was in a data breach at some point in time
    - contextPath: EmailRep.Email.details.first_seen
      type: Date
      description: the first date the email was observed in a breach, credential leak,
        or exhibiting malicious or spammy behavior (‘never’ if never seen)
    - contextPath: EmailRep.Email.details.last_seen
      type: Date
      description: the last date the email was observed in a breach, credential leak,
        or exhibiting malicious or spammy behavior (‘never’ if never seen)
    - contextPath: EmailRep.Email.details.domain_exists
      type: Boolean
      description: valid domain
    - contextPath: EmailRep.Email.details.domain_reputation
      type: String
      description: high/medium/low/n/a (n/a if the domain is a free_provider, disposable,
        or doesn’t exist)
    - contextPath: EmailRep.Email.details.new_domain
      type: Boolean
      description: the domain was created within the last year
    - contextPath: EmailRep.Email.details.days_since_domain_creation
      type: Number
      description: days since the domain was created
    - contextPath: EmailRep.Email.details.suspicious_tld
      type: Boolean
      description: suspicious tld
    - contextPath: EmailRep.Email.details.spam
      type: Boolean
      description: the email has exhibited spammy behavior (e.g. spam traps, login
        form abuse)
    - contextPath: EmailRep.Email.details.free_provider
      type: Boolean
      description: the email uses a free email provider
    - contextPath: EmailRep.Email.details.disposable
      type: Boolean
      description: the email uses a temporary/disposable service
    - contextPath: EmailRep.Email.details.deliverable
      type: Boolean
      description: deliverable
    - contextPath: EmailRep.Email.details.accept_all
      type: Boolean
      description: whether the mail server has a default accept all policy. some mail
        servers return inconsistent responses, so we may default to an accept_all
        for those to be safe
    - contextPath: EmailRep.Email.details.valid_mx
      type: Boolean
      description: has an MX record
    - contextPath: EmailRep.Email.details.spoofable
      type: Boolean
      description: email address can be spoofed (e.g. not a strict SPF policy or DMARC
        is not enforced)
    - contextPath: EmailRep.Email.details.spf_strict
      type: Boolean
      description: sufficiently strict SPF record to prevent spoofing
    - contextPath: EmailRep.Email.details.dmarc_enforced
      type: Boolean
      description: DMARC is configured correctly and enforced
    - contextPath: EmailRep.Email.details.profiles
      type: String
      description: online profiles used by the email
  - arguments:
    - default: true
      description: Email address to get reputation for
      isArray: false
      name: email
      required: true
      secret: false
    deprecated: false
    description: Get DBot score for email address using EmailRep reputation
    execution: false
    name: email
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: EmailRep.Email.email
      type: String
      description: email address queried
    - contextPath: EmailRep.Email.reputation
      type: String
      description: high/medium/low/none
    - contextPath: EmailRep.Email.suspicious
      type: Boolean
      description: whether the email address should be treated as suspicious or risky
    - contextPath: EmailRep.Email.references
      type: Number
      description: total number of positive and negative sources of reputation. note
        that these may not all be direct references to the email address, but can
        include reputation sources for the domain or other related information
    - contextPath: EmailRep.Email.details.blacklisted
      type: Boolean
      description: the email is believed to be malicious or spammy
    - contextPath: EmailRep.Email.details.malicious_activity
      type: Boolean
      description: the email has exhibited malicious behavior (e.g. phishing or fraud)
    - contextPath: EmailRep.Email.details.malicious_activity_recent
      type: Boolean
      description: malicious behavior in the last 90 days (e.g. in the case of temporal
        account takeovers)
    - contextPath: EmailRep.Email.details.credentials_leaked
      type: Boolean
      description: credentials were leaked at some point in time (e.g. a data breach,
        pastebin, dark web, etc.)
    - contextPath: EmailRep.Email.details.credentials_leaked_recent
      type: Boolean
      description: credentials were leaked in the last 90 days
    - contextPath: EmailRep.Email.details.data_breach
      type: Boolean
      description: the email was in a data breach at some point in time
    - contextPath: EmailRep.Email.details.first_seen
      type: Date
      description: the first date the email was observed in a breach, credential leak,
        or exhibiting malicious or spammy behavior (‘never’ if never seen)
    - contextPath: EmailRep.Email.details.last_seen
      type: Date
      description: the last date the email was observed in a breach, credential leak,
        or exhibiting malicious or spammy behavior (‘never’ if never seen)
    - contextPath: EmailRep.Email.details.domain_exists
      type: Boolean
      description: valid domain
    - contextPath: EmailRep.Email.details.domain_reputation
      type: String
      description: high/medium/low/n/a (n/a if the domain is a free_provider, disposable,
        or doesn’t exist)
    - contextPath: EmailRep.Email.details.new_domain
      type: Boolean
      description: the domain was created within the last year
    - contextPath: EmailRep.Email.details.days_since_domain_creation
      type: Number
      description: days since the domain was created
    - contextPath: EmailRep.Email.details.suspicious_tld
      type: Boolean
      description: suspicious tld
    - contextPath: EmailRep.Email.details.spam
      type: Boolean
      description: the email has exhibited spammy behavior (e.g. spam traps, login
        form abuse)
    - contextPath: EmailRep.Email.details.free_provider
      type: Boolean
      description: the email uses a free email provider
    - contextPath: EmailRep.Email.details.disposable
      type: Boolean
      description: the email uses a temporary/disposable service
    - contextPath: EmailRep.Email.details.deliverable
      type: Boolean
      description: deliverable
    - contextPath: EmailRep.Email.details.accept_all
      type: Boolean
      description: whether the mail server has a default accept all policy. some mail
        servers return inconsistent responses, so we may default to an accept_all
        for those to be safe
    - contextPath: EmailRep.Email.details.valid_mx
      type: Boolean
      description: has an MX record
    - contextPath: EmailRep.Email.details.spoofable
      type: Boolean
      description: email address can be spoofed (e.g. not a strict SPF policy or DMARC
        is not enforced)
    - contextPath: EmailRep.Email.details.spf_strict
      type: Boolean
      description: sufficiently strict SPF record to prevent spoofing
    - contextPath: EmailRep.Email.details.dmarc_enforced
      type: Boolean
      description: DMARC is configured correctly and enforced
    - contextPath: EmailRep.Email.details.profiles
      type: String
      description: online profiles used by the email
  - arguments:
    - default: false
      description: Email address being reported.
      isArray: false
      name: email_address
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Tags that should be applied. See detailed descriptions in EmailRep
        documentation for more information.
      isArray: true
      name: tags
      predefined:
      - account_takeover
      - bec
      - brand_impersonation
      - browser_exploit
      - credential_phishing
      - generic_phishing
      - malware
      - scam
      - spam
      - spoofed
      - task_request
      - threat_actor
      required: true
      secret: false
    - default: false
      description: Additional information and context.
      isArray: false
      name: description
      required: false
      secret: false
    - default: false
      description: When this activity occurred in UTC. Defaults to now().
      isArray: false
      name: timestamp
      required: false
      secret: false
    - default: false
      description: Number of hours the email should be considered risky (suspicious=true
        and blacklisted=true in the QueryResponse). Defaults to no expiration unless
        account_takeover tag is specified, in which case the default is 14 days.
      isArray: false
      name: expires
      required: false
      secret: false
    deprecated: false
    description: Report email address to EmailRep
    execution: false
    name: emailrep-email-address-report
  dockerimage: demisto/python3:3.8.6.12176
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
fromversion: 5.0.0
